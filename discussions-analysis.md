# –ê–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç—ã —Ä–∞–∑–¥–µ–ª–∞ "–û–±—Å—É–∂–¥–µ–Ω–∏–µ"

## –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–†–∞–∑–¥–µ–ª "–û–±—Å—É–∂–¥–µ–Ω–∏–µ" –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É `/discussions` –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–±—â–µ–Ω–∏—è —É—á–∏—Ç–µ–ª–µ–π —Å–æ —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏ –ø–æ —É—Ä–æ–∫–∞–º.

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã

#### 1. **–î–∞–Ω–Ω—ã–µ –ù–ï –±–µ—Ä—É—Ç—Å—è –∏–∑ –ë–î**

**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –º–æ–∫–æ–≤—ã–µ (—Ç–µ—Å—Ç–æ–≤—ã–µ) –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ.

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/app/discussions/page.tsx`

```typescript
// –ú–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
const mockDiscussions = [
  {
    id: '1',
    name: '–£—Ä–æ–∫ 5: –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è',
    student: '–ê–π–∂–∞–Ω –ú–∞–º–±–µ—Ç–æ–≤–∞',
    // ...
  },
  // ...
]

const mockMessages = [
  {
    id: '1',
    text: '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –£ –º–µ–Ω—è –≤–æ–ø—Ä–æ—Å...',
    // ...
  },
  // ...
]

// –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
const [discussions, setDiscussions] = useState(mockDiscussions)
const [chatMessages, setChatMessages] = useState(mockMessages)
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –í—Å–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ù–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

#### 2. **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç API —Ä–æ—É—Ç—ã**

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ—Ç API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±—Å—É–∂–¥–µ–Ω–∏—è–º–∏.

**–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–æ—É—Ç—ã (–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç):**
- `GET /api/teacher/discussions` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏–π
- `GET /api/teacher/discussions/[id]` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
- `GET /api/teacher/discussions/[id]/messages` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–±—Å—É–∂–¥–µ–Ω–∏—è
- `POST /api/teacher/discussions/[id]/messages` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- `PUT /api/teacher/discussions/[id]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è (–∑–∞–∫—Ä—ã—Ç–∏–µ, —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
```
src/app/api/teacher/
  ‚îú‚îÄ‚îÄ activity/
  ‚îú‚îÄ‚îÄ questions/
  ‚îú‚îÄ‚îÄ stats/
  ‚îî‚îÄ‚îÄ tests/
  ‚îî‚îÄ‚îÄ discussions/ ‚ùå –û–¢–°–£–¢–°–¢–í–£–ï–¢
```

#### 3. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö**

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–∏–ø `companion: 'teacher'`, –Ω–æ –≤ –ë–î enum `Companion` –∏–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏—è `student` –∏ `ai`.

**–°—Ö–µ–º–∞ –ë–î (`prisma/schema.prisma`):**
```prisma
enum Companion {
  student
  ai
}

model Discussion_chat {
  companion     Companion  // –¢–æ–ª—å–∫–æ student –∏–ª–∏ ai
  // ...
}
```

**–ö–æ–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:**
```typescript
const newMessage = {
  companion: 'teacher' as const,  // ‚ùå –ù–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ë–î
  // ...
}
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ë–î –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –æ—à–∏–±–∫–∞
- –ù—É–∂–Ω–æ –ª–∏–±–æ –¥–æ–±–∞–≤–∏—Ç—å `teacher` –≤ enum, –ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ai` –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π —É—á–∏—Ç–µ–ª—è

#### 4. **–§–∏–ª—å—Ç—Ä—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç**

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–∏–ª—å—Ç—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ UI, –Ω–æ –Ω–µ –∏–º–µ—é—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

**–ö–æ–¥ (`src/app/discussions/page.tsx`, —Å—Ç—Ä–æ–∫–∏ 217-236):**
```typescript
<div className="flex flex-wrap gap-2">
  <button className="...">–í—Å–µ</button>
  <button className="...">–ê–∫—Ç–∏–≤–Ω—ã–µ</button>
  <button className="...">–ó–∞–∫—Ä—ã—Ç—ã–µ</button>
  <button className="...">–° –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º–∏</button>
</div>
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ù–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–ª–∏–∫–æ–≤
- –ù–µ—Ç –ª–æ–≥–∏–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

#### 5. **–û–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î**

**–ü—Ä–æ–±–ª–µ–º—ã:**

1. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π** (`handleSendMessage`):
   - –°–æ–æ–±—â–µ–Ω–∏—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
   - –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
   - –ù–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î

2. **–ó–∞–∫—Ä—ã—Ç–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è** (`handleCloseDiscussion`):
   - –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ
   - –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
   - –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç—É—Å –≤–µ—Ä–Ω–µ—Ç—Å—è –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É

3. **–°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è** (`handleSummarize`):
   - –¢–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª—å
   - –ù–µ –≤—ã–∑—ã–≤–∞–µ—Ç API –¥–ª—è AI —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏
   - –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ø–æ–ª–µ `summarized_chat`

#### 6. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞ –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –º–æ–∫–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è.

**–ö–æ–¥:**
```typescript
const handleOpenChat = (discussionId: string) => {
  setSelectedDiscussion(discussionId)
  setIsChatOpen(true)
  // ‚ùå –ù–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
}
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

### –ú–æ–¥–µ–ª–∏ –≤ Prisma

#### `Discussions`
```prisma
model Discussions {
  id               String   @id @default(cuid())
  name             String
  lesson_id        String
  student_id       String
  summarized_chat  String?
  created_at       DateTime @default(now())
  updated_at       DateTime @updatedAt

  lesson          Lessons           @relation(...)
  student         Users             @relation(...)
  discussion_chat Discussion_chat[]
}
```

**–ü–æ–ª—è:**
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è (–Ω–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞)
- `lesson_id` - —Å–≤—è–∑—å —Å —É—Ä–æ–∫–æ–º
- `student_id` - —Å–≤—è–∑—å —Å–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–º
- `summarized_chat` - —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —á–∞—Ç–∞ (–¥–ª—è AI)
- `discussion_chat` - –º–∞—Å—Å–∏–≤ —Å–æ–æ–±—â–µ–Ω–∏–π

#### `Discussion_chat`
```prisma
model Discussion_chat {
  id            String     @id @default(cuid())
  discussion_id String
  companion     Companion  // student –∏–ª–∏ ai
  text          String
  created_at    DateTime   @default(now())
  updated_at    DateTime   @updatedAt

  discussion Discussions @relation(...)
}
```

**–ü–æ–ª—è:**
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `discussion_id` - —Å–≤—è–∑—å —Å –æ–±—Å—É–∂–¥–µ–Ω–∏–µ–º
- `companion` - –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å (student –∏–ª–∏ ai)
- `text` - —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

## –ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å

### 1. –°–æ–∑–¥–∞—Ç—å API —Ä–æ—É—Ç—ã

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã:**
```
src/app/api/teacher/discussions/
  ‚îú‚îÄ‚îÄ route.ts                    # GET - —Å–ø–∏—Å–æ–∫ –æ–±—Å—É–∂–¥–µ–Ω–∏–π, POST - —Å–æ–∑–¥–∞–Ω–∏–µ
  ‚îî‚îÄ‚îÄ [id]/
      ‚îú‚îÄ‚îÄ route.ts                # GET, PUT, DELETE - –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ
      ‚îî‚îÄ‚îÄ messages/
          ‚îî‚îÄ‚îÄ route.ts            # GET - —Å–æ–æ–±—â–µ–Ω–∏—è, POST - –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
```

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ GET `/api/teacher/discussions`:**
```typescript
export async function GET(request: NextRequest) {
  // –ü–æ–ª—É—á–∏—Ç—å ID —É—á–∏—Ç–µ–ª—è –∏–∑ —Ç–æ–∫–µ–Ω–∞
  // –ù–∞–π—Ç–∏ –≤—Å–µ —É—Ä–æ–∫–∏ —É—á–∏—Ç–µ–ª—è
  // –ù–∞–π—Ç–∏ –≤—Å–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –ø–æ —ç—Ç–∏–º —É—Ä–æ–∫–∞–º
  // –í–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å—Ç—É–¥–µ–Ω—Ç–∞—Ö –∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
}
```

### 2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î

**–í `src/app/discussions/page.tsx`:**

```typescript
useEffect(() => {
  const fetchDiscussions = async () => {
    try {
      const response = await fetch('/api/teacher/discussions')
      const data = await response.json()
      if (data.success) {
        setDiscussions(data.data)
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–π:', error)
    }
  }
  
  if (mounted) {
    fetchDiscussions()
  }
}, [mounted])
```

### 3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π

**–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞:**
```typescript
const handleOpenChat = async (discussionId: string) => {
  setSelectedDiscussion(discussionId)
  setIsChatOpen(true)
  
  // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —ç—Ç–æ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
  try {
    const response = await fetch(`/api/teacher/discussions/${discussionId}/messages`)
    const data = await response.json()
    if (data.success) {
      setChatMessages(data.data)
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:', error)
  }
}
```

### 4. –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ë–î

**–í `handleSendMessage`:**
```typescript
const handleSendMessage = async (message: string) => {
  if (!selectedDiscussion) return
  
  try {
    const response = await fetch(`/api/teacher/discussions/${selectedDiscussion}/messages`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        text: message,
        companion: 'ai' // –∏–ª–∏ 'teacher' –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ enum
      })
    })
    
    const result = await response.json()
    if (result.success) {
      // –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
      setChatMessages(prev => [...prev, result.data])
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:', error)
  }
}
```

### 5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã

```typescript
const [filter, setFilter] = useState<'all' | 'active' | 'closed' | 'unread'>('all')

const filteredDiscussions = discussions.filter(d => {
  switch (filter) {
    case 'active':
      return d.status === 'active'
    case 'closed':
      return d.status === 'closed'
    case 'unread':
      return (d.unreadCount || 0) > 0
    default:
      return true
  }
})
```

### 6. –ò—Å–ø—Ä–∞–≤–∏—Ç—å enum Companion

**–í–∞—Ä–∏–∞–Ω—Ç 1:** –î–æ–±–∞–≤–∏—Ç—å `teacher` –≤ enum
```prisma
enum Companion {
  student
  teacher  // –¥–æ–±–∞–≤–∏—Ç—å
  ai
}
```

**–í–∞—Ä–∏–∞–Ω—Ç 2:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ai` –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π —É—á–∏—Ç–µ–ª—è
```typescript
companion: 'ai' as const  // –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π —É—á–∏—Ç–µ–ª—è
```

### 7. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ

```typescript
const handleSummarize = async (discussionId: string) => {
  try {
    const response = await fetch(`/api/teacher/discussions/${discussionId}/summarize`, {
      method: 'POST'
    })
    const result = await response.json()
    if (result.success) {
      // –û–±–Ω–æ–≤–∏—Ç—å –æ–±—Å—É–∂–¥–µ–Ω–∏–µ —Å —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º
      setDiscussions(prev => prev.map(d => 
        d.id === discussionId 
          ? { ...d, summarized_chat: result.data.summary }
          : d
      ))
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:', error)
  }
}
```

## –í—ã–≤–æ–¥—ã

### ‚ùå –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –ù–ï –†–ê–ë–û–¢–ê–ï–¢ –ü–†–ê–í–ò–õ–¨–ù–û

1. **–î–∞–Ω–Ω—ã–µ –Ω–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ –ë–î** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
2. **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç API —Ä–æ—É—Ç—ã** - –Ω–µ—Ç —Å–≤—è–∑–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º
3. **–û–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** - –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
4. **–§–∏–ª—å—Ç—Ä—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç** - —Ç–æ–ª—å–∫–æ UI –±–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
5. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–æ–≤** - `companion: 'teacher'` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. **–õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** - –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ä–∞–º–∫–∞—Ö —Å–µ—Å—Å–∏–∏
3. **–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —á–∞—Ç–∞** - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
4. **–ü–µ—Ä–µ–≤–æ–¥—ã** - –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

### üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–°—Ä–æ—á–Ω–æ:** –°–æ–∑–¥–∞—Ç—å API —Ä–æ—É—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±—Å—É–∂–¥–µ–Ω–∏—è–º–∏
2. **–°—Ä–æ—á–Ω–æ:** –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î
3. **–í–∞–∂–Ω–æ:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å enum Companion –∏–ª–∏ –ª–æ–≥–∏–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
4. **–í–∞–∂–Ω–æ:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞
5. **–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ:** –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏ –ø–æ–∏—Å–∫
6. **–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å AI —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é

## –ê–Ω–∞–ª–∏–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å —Ç–µ–∫—É—â–µ–π –ë–î

### ‚úÖ –ß—Ç–æ –£–ñ–ï –µ—Å—Ç—å –≤ –ë–î –∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

#### 1. **–ú–æ–¥–µ–ª—å Discussions** - ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞
```prisma
model Discussions {
  id               String   @id @default(cuid())
  name             String   // –ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
  lesson_id        String   // –°–≤—è–∑—å —Å —É—Ä–æ–∫–æ–º
  student_id       String   // –°–≤—è–∑—å —Å–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–º
  summarized_chat  String?  // –î–ª—è AI —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏
  created_at       DateTime @default(now())
  updated_at       DateTime @updatedAt
  
  lesson          Lessons           @relation(...)
  student         Users             @relation(...)
  discussion_chat Discussion_chat[]
}
```

**–ß—Ç–æ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å:**
- ‚úÖ –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ–±—Å—É–∂–¥–µ–Ω–∏–π
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è (–∏–∑ –ø–æ–ª—è `name` –∏–ª–∏ `lesson.title`)
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç—É–¥–µ–Ω—Ç–µ (—á–µ—Ä–µ–∑ `student`)
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Ä–æ–∫–µ (—á–µ—Ä–µ–∑ `lesson`)
- ‚úÖ AI —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é (–ø–æ–ª–µ `summarized_chat`)

#### 2. **–ú–æ–¥–µ–ª—å Discussion_chat** - ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞
```prisma
model Discussion_chat {
  id            String     @id @default(cuid())
  discussion_id String
  companion     Companion  // student –∏–ª–∏ ai
  text          String
  created_at    DateTime   @default(now())
  updated_at    DateTime   @updatedAt
  
  discussion Discussions @relation(...)
}
```

**–ß—Ç–æ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å:**
- ‚úÖ –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è
- ‚úÖ –ê–≤—Ç–æ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (—á–µ—Ä–µ–∑ `companion`)
- ‚úÖ –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏
- ‚úÖ –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –ø–æ `created_at`)

#### 3. **–°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏** - ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç

**–ü–æ–ª—É—á–µ–Ω–∏–µ —É—á–∏—Ç–µ–ª—è:**
```
Discussions -> lesson -> lesson_group -> course -> created_by (ID —É—á–∏—Ç–µ–ª—è)
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —É—Ä–æ–∫–∞:**
```
Discussions -> lesson -> title, video_url, lecture_url, etc.
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–∞:**
```
Discussions -> student -> name, profile_photo_url, etc.
```

### ‚ö†Ô∏è –ß—Ç–æ –û–¢–°–£–¢–°–¢–í–£–ï–¢ –≤ –ë–î –∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

#### 1. **–°—Ç–∞—Ç—É—Å –æ–±—Å—É–∂–¥–µ–Ω–∏—è (active/closed)**

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –º–æ–¥–µ–ª–∏ `Discussions` –Ω–µ—Ç –ø–æ–ª—è –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å enum –∏ –ø–æ–ª–µ –≤ —Å—Ö–µ–º—É:
```prisma
enum DiscussionStatus {
  active
  closed
}

model Discussions {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  status DiscussionStatus @default(active)  // –î–û–ë–ê–í–ò–¢–¨
}
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏):**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–µ `updated_at` - –µ—Å–ª–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–æ—Å—å –¥–æ–ª–≥–æ, —Å—á–∏—Ç–∞—Ç—å –∑–∞–∫—Ä—ã—Ç—ã–º
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `summarized_chat` - –µ—Å–ª–∏ –µ—Å—Ç—å —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è, —Å—á–∏—Ç–∞—Ç—å –∑–∞–∫—Ä—ã—Ç—ã–º

#### 2. **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è, –∫–∞–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ—á–∏—Ç–∞–ª —É—á–∏—Ç–µ–ª—å.

**–†–µ—à–µ–Ω–∏–µ 1:** –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –≤ Discussions
```prisma
model Discussions {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  last_read_by_teacher_at DateTime?  // –î–û–ë–ê–í–ò–¢–¨
}
```

**–†–µ—à–µ–Ω–∏–µ 2:** –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
```prisma
model Discussion_read_status {
  id            String   @id @default(cuid())
  discussion_id String
  user_id       String
  last_read_at  DateTime @default(now())
  
  discussion Discussions @relation(...)
  user       Users       @relation(...)
  
  @@unique([discussion_id, user_id])
}
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏):**
- –°—á–∏—Ç–∞—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞
- –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—á–µ—Ç—á–∏–∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö

#### 3. **Enum Companion - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç 'teacher'**

**–ü—Ä–æ–±–ª–µ–º–∞:** –í enum —Ç–æ–ª—å–∫–æ `student` –∏ `ai`, –Ω–æ –Ω–µ—Ç `teacher`.

**–¢–µ–∫—É—â–∏–π enum:**
```prisma
enum Companion {
  student
  ai
}
```

**–†–µ—à–µ–Ω–∏–µ 1:** –î–æ–±–∞–≤–∏—Ç—å `teacher` –≤ enum
```prisma
enum Companion {
  student
  teacher  // –î–û–ë–ê–í–ò–¢–¨
  ai
}
```

**–†–µ—à–µ–Ω–∏–µ 2:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ai` –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π —É—á–∏—Ç–µ–ª—è
- –õ–æ–≥–∏–∫–∞: –µ—Å–ª–∏ `companion === 'ai'` –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç —É—á–∏—Ç–µ–ª—è ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞–∫ –æ—Ç —É—á–∏—Ç–µ–ª—è
- –ù–æ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ, –µ—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –ø–æ—è–≤—è—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ AI —Å–æ–æ–±—â–µ–Ω–∏—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å `teacher` –≤ enum (–†–µ—à–µ–Ω–∏–µ 1)

### üìä –ß—Ç–æ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏–π –ë–î:

#### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–°–ø–∏—Å–æ–∫ –æ–±—Å—É–∂–¥–µ–Ω–∏–π**
   ```typescript
   // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –¥–ª—è —É—á–∏—Ç–µ–ª—è
   const discussions = await prisma.discussions.findMany({
     where: {
       lesson: {
         lesson_group: {
           course: {
             created_by: teacherId
           }
         }
       }
     },
     include: {
       student: { select: { id: true, name: true, profile_photo_url: true } },
       lesson: { select: { id: true, title: true } },
       discussion_chat: {
         orderBy: { created_at: 'desc' },
         take: 1  // –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
       }
     },
     orderBy: { updated_at: 'desc' }
   })
   ```

2. **–°–æ–æ–±—â–µ–Ω–∏—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è**
   ```typescript
   const messages = await prisma.discussion_chat.findMany({
     where: { discussion_id: discussionId },
     orderBy: { created_at: 'asc' }
   })
   ```

3. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è**
   ```typescript
   await prisma.discussion_chat.create({
     data: {
       discussion_id: discussionId,
       companion: 'ai', // –∏–ª–∏ 'teacher' –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ enum
       text: message
     }
   })
   ```

4. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**
   - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Å—É–∂–¥–µ–Ω–∏–π ‚úÖ
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π (—á–µ—Ä–µ–∑ `discussion_chat`) ‚úÖ
   - –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É) ‚úÖ

#### ‚ö†Ô∏è –†–∞–±–æ—Ç–∞–µ—Ç —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏:

1. **–°—Ç–∞—Ç—É—Å –æ–±—Å—É–∂–¥–µ–Ω–∏—è**
   - –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–≤—Ä–∏—Å—Ç–∏–∫—É: –µ—Å–ª–∏ `updated_at` —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π ‚Üí closed
   - –ò–ª–∏ –µ—Å–ª–∏ –µ—Å—Ç—å `summarized_chat` ‚Üí closed

2. **–ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**
   - –ú–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `updated_at` –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∫–∞–∫ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**
   - –ü–æ –∞–∫—Ç–∏–≤–Ω—ã–º/–∑–∞–∫—Ä—ã—Ç—ã–º - —á–µ—Ä–µ–∑ —ç–≤—Ä–∏—Å—Ç–∏–∫—É ‚úÖ
   - –ü–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ ‚ö†Ô∏è

### üéØ –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞:

#### ‚úÖ –ú–û–ñ–ù–û —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏–π –ë–î (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏):

1. ‚úÖ –°–ø–∏—Å–æ–∫ –æ–±—Å—É–∂–¥–µ–Ω–∏–π —Å –¥–∞–Ω–Ω—ã–º–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏ —É—Ä–æ–∫–∞
2. ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–æ–±—â–µ–Ω–∏–π
3. ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (–∏—Å–ø–æ–ª—å–∑—É—è `companion: 'ai'` –¥–ª—è —É—á–∏—Ç–µ–ª—è)
4. ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π)
5. ‚úÖ –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
6. ‚ö†Ô∏è –°—Ç–∞—Ç—É—Å (—á–µ—Ä–µ–∑ —ç–≤—Ä–∏—Å—Ç–∏–∫—É)
7. ‚ö†Ô∏è –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ)

#### üîß –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –¥–æ–±–∞–≤–∏—Ç—å –≤ –ë–î:

1. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:**
   - `status DiscussionStatus` –≤ –º–æ–¥–µ–ª—å `Discussions`
   - `teacher` –≤ enum `Companion`

2. **–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ:**
   - `last_read_by_teacher_at DateTime?` –≤ –º–æ–¥–µ–ª—å `Discussions`
   - –ò–ª–∏ —Ç–∞–±–ª–∏—Ü—É `Discussion_read_status` –¥–ª—è –±–æ–ª–µ–µ –≥–∏–±–∫–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

### üìù –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã:

```prisma
enum DiscussionStatus {
  active
  closed
}

enum Companion {
  student
  teacher  // –î–û–ë–ê–í–ò–¢–¨
  ai
}

model Discussions {
  id               String   @id @default(cuid())
  name             String
  lesson_id        String
  student_id       String
  status           DiscussionStatus @default(active)  // –î–û–ë–ê–í–ò–¢–¨
  summarized_chat  String?
  last_read_by_teacher_at DateTime?  // –î–û–ë–ê–í–ò–¢–¨ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  created_at       DateTime @default(now())
  updated_at       DateTime @updatedAt
  
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
}
```

### ‚úÖ –í—ã–≤–æ–¥:

**–î–ê, –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞–∑–¥–µ–ª "–û–±—Å—É–∂–¥–µ–Ω–∏–µ" —Å —Ç–µ–∫—É—â–µ–π –ë–î**, –Ω–æ —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏:

- ‚úÖ **–ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª** (—Å–ø–∏—Å–æ–∫, —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–∫–∞) - —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
- ‚ö†Ô∏è **–°—Ç–∞—Ç—É—Å –æ–±—Å—É–∂–¥–µ–Ω–∏–π** - –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ —ç–≤—Ä–∏—Å—Ç–∏–∫—É, –Ω–æ –ª—É—á—à–µ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ
- ‚ö†Ô∏è **–ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ, –ª—É—á—à–µ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ
- ‚ö†Ô∏è **–¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏–π —É—á–∏—Ç–µ–ª—è** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ai` –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å `teacher` –≤ enum

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –º–∏–Ω–∏–º—É–º 2 –ø–æ–ª—è (`status` –∏ `teacher` –≤ enum) –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –±–µ–∑ –∫–æ—Å—Ç—ã–ª–µ–π.

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î

–í —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–¥–µ–ª–∞ "–û–±—Å—É–∂–¥–µ–Ω–∏–µ" –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

### üìä –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

#### 1. **`discussions`** (Discussions)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏–π –º–µ–∂–¥—É —É—á–∏—Ç–µ–ª–µ–º –∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–º –ø–æ —É—Ä–æ–∫—É.

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è:**
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ–±—Å—É–∂–¥–µ–Ω–∏—è
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è (–æ–±—ã—á–Ω–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞)
- `lesson_id` - —Å–≤—è–∑—å —Å —É—Ä–æ–∫–æ–º
- `student_id` - —Å–≤—è–∑—å —Å–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–º
- `summarized_chat` - —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —á–∞—Ç–∞ (–¥–ª—è AI, —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–∫—Ä—ã—Ç–∏—è)
- `created_at` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `updated_at` - –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞)

**–û–ø–µ—Ä–∞—Ü–∏–∏:**
- ‚úÖ `SELECT` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏–π –¥–ª—è —É—á–∏—Ç–µ–ª—è
- ‚úÖ `SELECT` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
- ‚úÖ `INSERT` - —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
- ‚úÖ `UPDATE` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è (–∑–∞–∫—Ä—ã—Ç–∏–µ, —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ)

**–°–≤—è–∑–∏:**
- `lesson` ‚Üí `Lessons` (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)
- `student` ‚Üí `Users` (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)
- `discussion_chat` ‚Üí `Discussion_chat[]` (–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º)

---

#### 2. **`discussion_chat`** (Discussion_chat)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¢–∞–±–ª–∏—Ü–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏—è—Ö.

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è:**
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è
- `discussion_id` - —Å–≤—è–∑—å —Å –æ–±—Å—É–∂–¥–µ–Ω–∏–µ–º
- `companion` - –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å (`student` –∏–ª–∏ `ai` –¥–ª—è —É—á–∏—Ç–µ–ª—è)
- `text` - —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- `created_at` - –¥–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
- `updated_at` - –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–û–ø–µ—Ä–∞—Ü–∏–∏:**
- ‚úÖ `SELECT` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ–±—Å—É–∂–¥–µ–Ω–∏—è (—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `created_at`)
- ‚úÖ `SELECT` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (–¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å–ø–∏—Å–∫–µ)
- ‚úÖ `INSERT` - —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ `COUNT` - –ø–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏–∏

**–°–≤—è–∑–∏:**
- `discussion` ‚Üí `Discussions` (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É, –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)

---

### üîó –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (–¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö)

#### 3. **`users`** (Users)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç—É–¥–µ–Ω—Ç–µ –∏ —É—á–∏—Ç–µ–ª–µ.

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è:**
- `id` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `name` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å–ø–∏—Å–∫–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–π)
- `profile_photo_url` - —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è (–¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏—è –∏–º–µ–Ω–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è —É—á–∏—Ç–µ–ª—é (—á–µ—Ä–µ–∑ —Å–≤—è–∑–∏)

**–°–≤—è–∑–∏:**
- `discussions` ‚Üí `Discussions[]` (–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º)

---

#### 4. **`lessons`** (Lessons)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Ä–æ–∫–µ, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –æ–±—Å—É–∂–¥–µ–Ω–∏–µ.

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è:**
- `id` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Ä–æ–∫–∞
- `title` - –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è, –µ—Å–ª–∏ `name` –Ω–µ —É–∫–∞–∑–∞–Ω–æ)

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è —É—Ä–æ–∫–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ —É—Ä–æ–∫–∞ —É—á–∏—Ç–µ–ª—é (—á–µ—Ä–µ–∑ —Å–≤—è–∑–∏)

**–°–≤—è–∑–∏:**
- `lesson_group` ‚Üí `Lesson_groups` (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)
- `discussions` ‚Üí `Discussions[]` (–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º)

---

#### 5. **`lesson_groups`** (Lesson_groups)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è —Å–≤—è–∑–∏ —É—Ä–æ–∫–∞ —Å –∫—É—Ä—Å–æ–º.

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è:**
- `id` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≥—Ä—É–ø–ø—ã —É—Ä–æ–∫–æ–≤
- `course_id` - —Å–≤—è–∑—å —Å –∫—É—Ä—Å–æ–º

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–∞, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —É—Ä–æ–∫
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ —É—Ä–æ–∫–∞ —É—á–∏—Ç–µ–ª—é

**–°–≤—è–∑–∏:**
- `course` ‚Üí `Courses` (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)
- `lessons` ‚Üí `Lessons[]` (–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º)

---

#### 6. **`courses`** (Courses)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—è –∫—É—Ä—Å–∞ (—É—á–∏—Ç–µ–ª—è).

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è:**
- `id` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫—É—Ä—Å–∞
- `created_by` - ID —É—á–∏—Ç–µ–ª—è, —Å–æ–∑–¥–∞–≤—à–µ–≥–æ –∫—É—Ä—Å

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–π –ø–æ —É—á–∏—Ç–µ–ª—é
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (—Ç–æ–ª—å–∫–æ —É—á–∏—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –æ–±—Å—É–∂–¥–µ–Ω–∏—è —Å–≤–æ–∏—Ö —É—Ä–æ–∫–æ–≤)

**–°–≤—è–∑–∏:**
- `creator` ‚Üí `Users` (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)
- `lesson_groups` ‚Üí `Lesson_groups[]` (–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º)

---

### üìã –°—Ö–µ–º–∞ —Å–≤—è–∑–µ–π —Ç–∞–±–ª–∏—Ü

```
Courses (created_by: teacher_id)
  ‚îî‚îÄ‚îÄ Lesson_groups (course_id)
        ‚îî‚îÄ‚îÄ Lessons (lesson_group_id)
              ‚îî‚îÄ‚îÄ Discussions (lesson_id)
                    ‚îú‚îÄ‚îÄ Users (student_id) - —Å—Ç—É–¥–µ–Ω—Ç
                    ‚îî‚îÄ‚îÄ Discussion_chat (discussion_id) - —Å–æ–æ–±—â–µ–Ω–∏—è
```

### üîç –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏–π:
```sql
SELECT d.*, u.name as student_name, l.title as lesson_title
FROM discussions d
JOIN users u ON d.student_id = u.id
JOIN lessons l ON d.lesson_id = l.id
JOIN lesson_groups lg ON l.lesson_group_id = lg.id
JOIN courses c ON lg.course_id = c.id
WHERE c.created_by = :teacherId
ORDER BY d.updated_at DESC
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–±—Å—É–∂–¥–µ–Ω–∏—è:
```sql
SELECT *
FROM discussion_chat
WHERE discussion_id = :discussionId
ORDER BY created_at ASC
```

#### –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
```sql
INSERT INTO discussion_chat (discussion_id, companion, text, created_at, updated_at)
VALUES (:discussionId, 'ai', :text, NOW(), NOW());

UPDATE discussions 
SET updated_at = NOW()
WHERE id = :discussionId;
```

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü

| –¢–∞–±–ª–∏—Ü–∞ | –û–ø–µ—Ä–∞—Ü–∏–∏ | –ß–∞—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è |
|---------|----------|----------------------|
| `discussions` | SELECT, INSERT, UPDATE | –í—ã—Å–æ–∫–∞—è (–ø—Ä–∏ –∫–∞–∂–¥–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã) |
| `discussion_chat` | SELECT, INSERT, COUNT | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è (–ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞, –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è) |
| `users` | SELECT | –°—Ä–µ–¥–Ω—è—è (–ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–ø–∏—Å–∫–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏–π) |
| `lessons` | SELECT | –°—Ä–µ–¥–Ω—è—è (–ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–ø–∏—Å–∫–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏–π) |
| `lesson_groups` | SELECT | –ù–∏–∑–∫–∞—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞) |
| `courses` | SELECT | –ù–∏–∑–∫–∞—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞) |

### ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ:** –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è (`onDelete: Cascade`)

2. **–ò–Ω–¥–µ–∫—Å—ã:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
   - `discussions.lesson_id` - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ —É—Ä–æ–∫—É
   - `discussions.student_id` - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ —Å—Ç—É–¥–µ–Ω—Ç—É
   - `discussion_chat.discussion_id` - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
   - `discussion_chat.created_at` - –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

3. **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:** –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–π (—Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è + –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è)

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–∞–∑–¥–µ–ª "–û–±—Å—É–∂–¥–µ–Ω–∏–µ" –≤ —Ç–µ–∫—É—â–µ–º –≤–∏–¥–µ **–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö** –∏ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º. –î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤—ã—à–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

**–° —Ç–µ–∫—É—â–µ–π –ë–î –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**, –Ω–æ –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è `status` –∏ —Ä–∞—Å—à–∏—Ä–∏—Ç—å enum `Companion`.

